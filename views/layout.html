{{define "layout.html"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Alby - Nostr Wallet Connect</title>
    <link href="/public/css/application.css?v202303281" rel="stylesheet" />
    <link href="/public/css/fonts.css?v202303281" rel="stylesheet" />
    <link rel="icon" href="/public/images/nwc-logo.svg" />
  </head>

  <body class="bg-gray-50 dark:bg-surface-00dp">
    <div
      class="bg-white border-b border-gray-200 dark:bg-surface-01dp dark:border-neutral-700 mb-6"
    >
      <nav class="container max-w-screen-lg mx-auto px-4 lg:px-0 py-3">
        <div class="flex justify-between items-center">
          <div class="flex items-center space-x-12">
            <a href="/" class="font-headline text-[20px] dark:text-white">
              <img
                alt="NWC Logo"
                class="w-8 inline"
                width="128"
                height="120"
                src="/public/images/nwc-logo.svg"
              />
              <span class="dark:text-white text-lg font-semibold hidden sm:inline"
                >Nostr Wallet Connect</span
              >
            </a>

            <div class="hidden md:flex space-x-4">
              <a
                class="text-gray-400 font-medium hover:text-gray-600 dark:hover:text-gray-300 transition"
                href="/apps"
              >
                Connections
              </a>
              <a class="text-gray-400 pl-5 font-medium" href="/about">
                About
              </a>
            </div>
          </div>
          {{if .User}}
          <div class="flex items-center relative">
            <p class="text-gray-400 dark:text-gray-400 text-xs font-medium sm:text-base cursor-pointer select-none " id="dropdown-menu">
              {{.User.Email}}
              <img
                id="caret"
                class="inline cursor-pointer w-4 ml-2"
                src="/public/images/caret.svg"
              />
            </p>
              <div class="font-medium flex flex-col hidden px-4 w-40 logout absolute right mt-25 justify-left cursor-pointer rounded-lg border border-gray-200 dark:border-gray-200 text-center bg-white dark:bg-surface-01dp shadow" id="dropdown">
                <a class="md:hidden flex items-center justify-left  py-2 text-gray-400 dark:text-gray-400" href="/about">
                  <img class="inline cursor-pointer w-4 mr-3" src="/public/images/about.svg" alt="about-svg"><p class="font-normal">About</p>
                </a>
                <a class="flex items-center justify-left py-2 text-red-500" href="/logout">
                  <img class="inline cursor-pointer w-4 mr-3" src="/public/images/logout.svg" alt="logout-svg"><p class="font-normal">Logout</p>
                </a>
              </div>
          </div>
          {{end}}
        </div>
      </nav>
    </div>
    <main class="container max-w-screen-lg mx-auto px-4 lg:px-0 flex flex-col">
      {{template "body" .}}
    </main>
    <footer class="mt-20 mb-4 text-center">
      <span class="text-gray-500 dark:text-neutral-300 text-xs"
        >Made with ðŸ’œ by</span
      >
      <a href="https://getalby.com?utm_source=nwc" rel="noreferrer noopener">
        <img
          id="alby-logo"
          src="/public/images/alby-logo-with-text.svg"
          class="w-16 inline"
        />
      </a>
    </footer>
  </body>

  <script type="text/javascript">
    if (window.location.pathname.startsWith("/apps")) {
      const link = document.querySelector('a[href="/apps"]');
      link.classList.remove("text-gray-400");
      link.classList.add("text-gray-900", "dark:text-gray-100");
    }
    if (window.location.pathname.startsWith("/about")) {
      const link = document.querySelector('a[href="/about"]');
      link.classList.remove("text-gray-400");
      link.classList.add("text-gray-900", "dark:text-gray-100");
    }
    function updateLogo() {
      const isDarkMode = window.matchMedia(
        "(prefers-color-scheme: dark)"
      ).matches;
      const logoImages = document.querySelectorAll("#alby-logo");

      if (isDarkMode) {
        logoImages.forEach((logoImage) => {
          logoImage.src = "/public/images/alby-logo-with-text-dark.svg";
        });
      } else {
        logoImages.forEach((logoImage) => {
          logoImage.src = "/public/images/alby-logo-with-text.svg";
        });
      }
    }
    const dropdownMenu = document.getElementById("dropdown-menu");
    const caret = document.getElementById("caret");
    dropdownMenu.addEventListener('click',()=>{
      const dropdown = document.getElementById("dropdown");
      dropdown.classList.toggle("hidden");
      caret.classList.toggle("rotate-180");
    });
    window.addEventListener("load", updateLogo);
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", updateLogo);
  </script>
</html>
{{end}}
